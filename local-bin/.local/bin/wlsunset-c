#!/bin/sh

sendWfNotif() {
	notify-send \
		-a 'wlsunset' \
		-- \
		'wlsunset' \
		"$1"
}

printUsage() {
	>&2 cat <<EOF
usage: $(basename "$0") start|toggle
    $(tput bold)start$(tput sgr0) is for the startup, and does not send a notification
    $(tput bold)toggle$(tput sgr0) toggles the program on or off and sends a notification
EOF
}

if [ ! "$#" = 1 ]; then
	printUsage
	exit 1
fi
case "$1" in
start)
	if >/dev/null pgrep -x wlsunset; then
		echo "wlsunset is already running. did you mean to toggle with $(tput bold)wlsunset-c toggle$(tput sgr0)?" >&2
		exit 1
	fi
	wlsunset -l "$LATITUDE" -L "$LONGITUDE"
	exit 0
	;;
toggle)

	if pkill -x wlsunset; then
		sendWfNotif 'toggled off.'
	else
		wlsunset -l "$LATITUDE" -L "$LONGITUDE" &
		sendWfNotif 'toggled on.'
	fi
	;;
*)
	printUsage
	exit 1
	;;
esac
